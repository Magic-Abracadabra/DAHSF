1. [Paper Link](https://www.alphaxiv.org/abs/2412.14054)
2. [Hugging Face](https://huggingface.co/Magic-Abracadabra/DAHSF)
# Abstract
Text Normalization and Semantic Parsing have numerous applications in natural language processing, such as natural language programming, paraphrasing, data augmentation, constructing expert systems, text matching, and more. Despite the prominent achievements of deep learning in Large Language Models (LLMs), the interpretability of neural network architectures is still poor, which affects their credibility and hence limits the deployments of risk-sensitive scenarios. In certain scenario-specific domains with scarce data, rapidly obtaining a large number of supervised learning labels is challenging, and the workload of manually labeling data would be enormous. Catastrophic forgetting in neural networks further leads to low data utilization rates. In situations where swift responses are vital, the density of the model makes local deployment difficult and the response time long, which is not conducive to local applications of these fields. Inspired by the multiplication rule, a principle of combinatorial mathematics, and human thinking patterns, a multilayer framework along with its algorithm, the Digestion Algorithm in Hierarchical Symbolic Forests (DAHSF), is proposed to address these above issues, combining text normalization and semantic parsing workflows. The Chinese Scripting Language "Fire Bunny Intelligent Development Platform V2.0" is an important test and application of the technology discussed in this paper. DAHSF can run locally in scenario-specific domains on little datasets, with model size and memory usage optimized by at least two orders of magnitude, thus improving the execution speed, and possessing a promising optimization outlook.
# Significant Declaration
Due to very limited resources (esp. equipments), the data (not including DAHSF) in this table was generated by ChatGLM-4.

# 渐得如意智能自动化办公平台
## 基本语法
1. 建议服从基本的汉语语法，用标点符号结尾，形成一个句子；
2. 初始时，用户可以使用自然语言的标点符号“！”“；”“，”“。”等作为命令分隔符（回车也可以，但是专门用于脚本文件内容）。所有可用的分隔符保存在数据库中（本平台的“数据库”文件夹），可以修改“数据库\分隔符.txt”来更改自己的分隔符偏好；
一个句子中的词语要么被解析为数据词，要么被解析为关键词
## 使用本平台
### 两种基本交互方式
1. 调试窗口：直接双击“渐得如意”，进入界面之后就可以直接编写，调试，编辑，浏览，运行本平台命令；支持一行多个句子的命令，但不支持多行输入
  * 当输入命令然后按回车时，执行用户输入的命令
  * 当输入内容不是本平台命令然后按回车时，本平台会根据用户反馈的“是否输错命令”决定是否要向用户学习
2. 开发脚本文件：“机关文件”与“秘籍文件”是本平台的脚本文件，可用记事本编辑开发；二者均可被本平台直接打开。如若代码中存在非命令语句，平台会整体报错提示。
### 查看帮助
初始的程序有“帮助”命令。输入这个命令后，渐得如意首先会自我介绍。

<img width="415" height="234" alt="image" src="https://github.com/user-attachments/assets/d9b62499-8492-4208-8c2c-fdab9cde1c2c" />

单击“确定”后，渐得如意会向用户询问是否需要展示本平台的全部最简命令。如果用户点击“确定”，渐得如意会命令系统启动帮助文档。

<img width="206" height="96" alt="image" src="https://github.com/user-attachments/assets/4dc1c11a-749e-41ed-8eae-cd79e748b170" />

由于本平台的命令是自定义的，帮助文档是现场生成的，因此用户可以明确地利用这点追踪本平台当下的能力边界。如果用户定义了一些新命令，重新生成帮助文档后，帮助文档的内容也会相应变化。为了不过度占用用户电脑磁盘空间，帮助文档生成后，默认会被本平台删除。

如下图，在帮助文档中，标题指明了命令的类型（以下称为“命令类型”）。位于括号“（”和“）”之间的是数据词，而剩下的非标题内容都是关键词。这个帮助文档只展示了全部现有的自定义命令的代表形式，其它与它们同义的命令语句则不被展示。不同的命令之间用“，”隔开。

<img width="415" height="241" alt="image" src="https://github.com/user-attachments/assets/cb168d8b-bb48-45df-8d4d-a083cda2ef58" />

帮助中的命令可以直接使用。比如在本平台中打出“卸载”两个字，然后回车。

<img width="415" height="234" alt="image" src="https://github.com/user-attachments/assets/5fb07f31-85fb-4ae8-a4ae-eda927758053" />

之后，本平台就会执行对应的Python命令。例如这个案例中，启动的是系统设置中的程序列表。可以通过本平台看到，这个命令的命令类型是“打开并跳转”。

<img width="416" height="92" alt="image" src="https://github.com/user-attachments/assets/95b7c2d6-477e-4ee7-bbe0-ffa74c44b6d4" />

用户可以单行输入多个命令，命令之间请用命令分割符隔开，本平台会依次执行。如果用户编写本平台支持的脚本文件，命令分隔符则多支持一个回车，但需要用户严格使用自己定义的表述方式。
### 让电脑“渐得如意”
这个功能是本平台用于让模型“学习”的工作流程。比如，我要定义一个新命令，我输入了下面的这段内容：
```渐得如意
到19：00时，打开记事本
```
首先，渐得如意会向用户确认是否打错了命令，所有问题用户需要如实准确地回答。

<img width="415" height="234" alt="image" src="https://github.com/user-attachments/assets/f60af7a3-e5eb-48dc-aeab-af170043ee41" />

<img width="318" height="115" alt="image" src="https://github.com/user-attachments/assets/c74783f3-ba90-4c10-a67b-3528740b3f5e" />

添加新命令，意味着这个命令以前渐得如意没有见过，那么这个表达方式本平台也没有见过，因此用户需回答“是”。

如果出现了渐得如意以前没有见过的新词语，或者是以前的“词语”连起来会出现新的含义。在前者的情况，渐得如意会询问用户：

<img width="143" height="105" alt="image" src="https://github.com/user-attachments/assets/de4fff5d-fc24-49e7-b04c-7cdc6c3b7239" />

然而在后者的情况，则会问：

<img width="198" height="108" alt="image" src="https://github.com/user-attachments/assets/f1e28355-ab41-4487-b501-8ce9e33c2351" />

如果在前者的情况否定，例如这个例子中，用户实际上希望“19：00”表示时间，“时”则表示“时候”的意思。渐得如意自动提取功能并不符合用户的预期，因此用户要选择“否”，然后手动按照提示输入内容。在后者的情况中，则是选择“是”。

<img width="415" height="50" alt="image" src="https://github.com/user-attachments/assets/7b21bf49-ff9b-4566-b7e6-25d0897da5f2" />

<img width="415" height="233" alt="image" src="https://github.com/user-attachments/assets/4146352a-a0b5-4567-9847-6cf3884f5992" />

每次用户输入完毕，渐得如意都会给用户确认的机会。在这个例子中，“时”是词库中的新词语，就像我们遇到了一个以前从来没有见过的生僻字或陌生词汇一样。因此，选择“否”后确认“时”的词性是“名词”。

<img width="415" height="234" alt="image" src="https://github.com/user-attachments/assets/bb92852b-caa1-4796-bd4a-753ec2ce2ef5" />

渐得如意学习完词语后，就要学相关的句子。显然在这个例子中，我们的命令是全新的。在下图中，选择“否”。我们需要定义一种新的命令，其命令类型为“流程与计算”。

<img width="415" height="218" alt="image" src="https://github.com/user-attachments/assets/bbceaeb5-f9ef-4a73-9dc6-8403066305e3" />

<img width="415" height="234" alt="image" src="https://github.com/user-attachments/assets/45b89ac3-aaaa-48a7-94c8-d5c9ebaa6a7e" />

这个记事本会自动弹出。编辑好代码之后，下次就可以正常运行了。Python代码中，“第三层数据”是一个Python列表，依次记录了这个命令中的全部数据词。比如，利用这个命令，就可以设置19：05的闹钟了。这个音频就会准时地在这个时间打开。

<img width="416" height="234" alt="image" src="https://github.com/user-attachments/assets/1a279749-f47b-4ab1-8c4a-a0e02c323220" />

可以用新执行的帮助命令发现，在“流程与计算”这种命令类型中，增添了这个命令。

<img width="415" height="36" alt="image" src="https://github.com/user-attachments/assets/8f54072c-6c91-44b2-b1df-2f08a69c0de1" />

如果用户打错了命令，渐得如意会试图猜测用户的正确命令。如果本平台猜对了，那就执行更正后的命令。后续正常的命令继续执行。下图展示了一个正确的猜测，用户确认后，渐得如意则会完整执行修正后的命令，即“新建桌面，等候1秒，打开画图软件”。可以看到，执行前只有一个桌面1，执行后在桌面2中有一个画图软件。

<img width="415" height="60" alt="image" src="https://github.com/user-attachments/assets/5789e62e-4bf7-4aed-8320-fd8b3a1fec85" />

<img width="415" height="234" alt="image" src="https://github.com/user-attachments/assets/dee55c80-0911-4dfe-9ef0-17ea1b0f481b" />

<img width="415" height="234" alt="image" src="https://github.com/user-attachments/assets/f058769d-d37d-4f65-a3dd-57b76be329b7" />

<img width="415" height="217" alt="image" src="https://github.com/user-attachments/assets/11ed2066-daa5-4450-94f3-bad51457cc20" />

我们讨论最后一种情况——一个Python指令对应多种表达方式的可能。本平台的同义对应支持2个层次——词语层次和句子层次。我们以句子层次的同义对应为例，从刚才的“到19：05时”出发，现在我们更改它的时间点，比如改为“20：00”，并更改这个命令的表达方式，把它改成“等待至20：00”。

<img width="415" height="233" alt="image" src="https://github.com/user-attachments/assets/1af64824-e116-47af-992d-a1bfcc3f6808" />

<img width="415" height="234" alt="image" src="https://github.com/user-attachments/assets/f5433122-c104-43b1-8697-4c08e6ebee71" />

可以从这里看出，所有的词汇本平台都有，因此这里选“否”。然后在下图的这一步中选择“是”（如果用户忘记了之前定义了什么命令或者词语，都可以在终端的显示区查找到）。

<img width="415" height="234" alt="image" src="https://github.com/user-attachments/assets/889a6ebb-ea5b-47bb-a733-3c5dfa426033" />

这里，请用户重新表述这个命令，使之成为渐得如意熟悉的版本。在这里用户需要输入“到20：00时”并确认。现在，这段命令及其之后的命令就可以正常依次执行了。

<img width="416" height="234" alt="image" src="https://github.com/user-attachments/assets/a9a12490-f6eb-43e2-970a-55813c3f889a" />

## 平台功能与特色
功能上，本平台可学习用户的词汇、（最好符合中文语法的）句法，并且允许用户使用个性化但相对自由多样的表述方式下达用户自己定义的Python指令。本平台既可以通过“渐得如意”直接命令交互，又可以用“渐得如意”打开中文命令脚本。

特点上，本平台，作为这类架构的典型应用场景，延续了这类架构的特点。本平台因其所采用的架构，能在CPU上学习、本地运行、离线解析命令（除非自定义的指令内容需要联网）。一旦学习完毕，执行知识库内的指令迅速且较为稳定，可靠度高。模型架构之外，本平台使用中文作为脚本语言，无需手动编译就可以执行脚本。

## 模型架构以外的术语
1. 脚本文件：用纯文本保存的程序文件，常用于自动化的批处理，在Windows操作系统中，打开它可以直接运行；
命令：在本平台中被用户定义、使用、编写、编辑且能被本平台执行的代码，本平台脚本语言的具体内容之一（例如，“你好！”在初始化的程序中是一句命令）；
2. 渐得如意：主程序，也就是本平台的IDLE（集成开发环境），是一个调试窗口，能够向用户学习新命令、用户可以编写调试编辑浏览运行本平台命令的界面；
3. 机关文件：本质上是后缀名为“.机关”的文本文件，可以被本平台打开；
4. 秘籍文件：类似于机关文件。
5. 数据词：在一个句子中模式或内容灵活多样且内容难以直接被上下文完全预测，但是可以被归类的句子片段。例如，在句子
```plaintext
进入https://github.com/Magic-Abracadabra/All-Agents-Are-Evolving-Translators。
```
中，“[https://github.com/Magic-Abracadabra/All-Agents-Are-Evolving-Translators](https://github.com/Magic-Abracadabra/All-Agents-Are-Evolving-Translators)”就是一个典型的数据词。

6. 关键词：句子中除去数据词以外的部分，它们稳定而且具备上下文关联性强的特点，构成了句子的框架。例如上述案例中，“进入”是一个关键词，句子的框架可以看成“进入（网址）”。当关键词组成一定的框架后，在框架的空缺处填充恰当类型的数据词，便可以形成正确而完整的句子。
